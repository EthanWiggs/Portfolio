const INCOMER_TYPES=[{partID:"PB3153/ICM",name:"400A 3 POLE PANEL BOARD INCOMER",cost:400},{partID:"PB3154/ICM",name:"400A 4 POLE PANEL BOARD INCOMER",cost:400},{partID:"PB4003/ICM",name:"400A 3 POLE PANEL BOARD INCOMER",cost:400},{partID:"PB4004/ICM",name:"400A 4 POLE PANEL BOARD INCOMER",cost:400},{partID:"PB3154/ICS",name:"400A 4 POLE PANEL BOARD SWITCH INCOMER",cost:400}],SPINE_TYPES=[{partID:"PB400/06",name:"400A PANEL BOARD 6TP WAYS",max:6,cost:400},{partID:"PB400/06+2",name:"400A PANEL BOARD 6+2 TP WAYS",max:6,supportsLargeOutgoer:!0,cost:400},{partID:"PB400/08",name:"400A PANEL BOARD 8TP WAYS",max:8,cost:400},{partID:"PB400/08+2",name:"400A PANEL BOARD 8+2 TP WAYS",max:8,supportsLargeOutgoer:!0,cost:400},{partID:"PB400/12",name:"400A PANEL BOARD 12TP WAY",max:12,cost:400},{partID:"PB400/12+2",name:"400A PANEL BOARD 12+2 TP WAY",max:12,supportsLargeOutgoer:!0,cost:400},{partID:"PB400/16",name:"400A PANEL BOARD 16TP WAY",max:16,cost:400},{partID:"PB400/16+2",name:"400A PANEL BOARD 16+2 TP WAY",max:16,supportsLargeOutgoer:!0,cost:400}],OUTGOER_LESSTHAN_125A_TYPES=[{partID:"MC1P016",name:"MCCB 1P 16A",spaceRequired:1,cost:16},{partID:"MC1P020",name:"MCCB 1P 20A",spaceRequired:1,cost:20},{partID:"MC1P025",name:"MCCB 1P 25A",spaceRequired:1,cost:25},{partID:"MC1P032",name:"MCCB 1P 32A",spaceRequired:1,cost:32},{partID:"MC1P040",name:"MCCB 1P 40A",spaceRequired:1,cost:40},{partID:"MC1P050",name:"MCCB 1P 50A",spaceRequired:1,cost:50},{partID:"MC1P063",name:"MCCB 1P 63A",spaceRequired:1,cost:63},{partID:"MC1P080",name:"MCCB 1P 80A",spaceRequired:1,cost:80},{partID:"MC1P100",name:"MCCB 1P 100A",spaceRequired:1,cost:100},{partID:"MC1P125",name:"MCCB 1P 125A",spaceRequired:1,cost:125},{partID:"MC3P025",name:"MCCB 3P 25A",spaceRequired:3,cost:25},{partID:"MC3P040",name:"MCCB 3P 40A",spaceRequired:3,cost:40},{partID:"MC3P063",name:"MCCB 3P 63A",spaceRequired:3,cost:63},{partID:"MC3P100",name:"MCCB 3P 100A",spaceRequired:3,cost:100},{partID:"MC3P125",name:"MCCB 3P 125A",spaceRequired:3,cost:125}],OUTGOER_125A_OR_MORE_TYPES=[{partID:"MC3P160",name:"MCCB 3P 160A",cost:160},{partID:"MC3P200",name:"MCCB 3P 200A",cost:200},{partID:"MC3P250",name:"MCCB 3P 250A",cost:250},],ACCESSORIES=[{partID:"PB/SPD-100KA",name:"SURGE KIT TYPE 1+2",cost:100},{partID:"PB400-MID",name:"SINGLE METER KIT",cost:50},{partID:"PB/KL",name:"KEY LOCK",cost:25},{partID:"PB400/AB",name:"TYPE A ACCESSORY BOX",cost:75},{partID:"PB400/EB",name:"EXTENSION BOX",cost:75},],PICKERS=[{id:"c1",title:"Incomer – Choose one only",type:"single",palette:INCOMER_TYPES},{id:"c2",title:"Spine – Choose one only",type:"single",palette:SPINE_TYPES},{id:"c3",title:"Outgoer > 125A - Maximum 2 Units",type:"multi",max:2,palette:OUTGOER_125A_OR_MORE_TYPES,allowQuantity:!0},{id:"c4",title:"Outgoer ≤ 125A",type:"multi",max:18,palette:OUTGOER_LESSTHAN_125A_TYPES,allowQuantity:!0},{id:"c5",title:"Accessories",type:"multi",max:7,palette:ACCESSORIES},],state={c1:[],c2:[],c3:[],c4:[],c5:[]};PICKERS.forEach(e=>{e.allowQuantity&&(state[`${e.id}_qty`]={})});const pickersRoot=document.getElementById("pickers");function findPaletteEntryByPartID(e,t){return Array.isArray(e)&&e.find(e=>e.partID===t||e.partId===t||e.id===t)||null}function setSwatchDisabled(e,t){if(!e)return;let a=e.querySelector("input");t?(e.classList.add("disabled"),e.dataset.disabled="true",a&&(a.disabled=!0),e.style.pointerEvents="none",e.style.opacity=".45"):(e.classList.remove("disabled"),e.dataset.disabled="false",a&&(a.disabled=!1),e.style.pointerEvents="",e.style.opacity="")}function getTotalPorts(){let e=state.c2[0];if(!e)return 18;let t=findPaletteEntryByPartID(SPINE_TYPES,e);return t?3*(t.max||6):18}function calculateUsedPortsForC4Model(){let e=0;if(Array.isArray(state.c4)){let t=OUTGOER_LESSTHAN_125A_TYPES;state.c4.forEach(a=>{let l=findPaletteEntryByPartID(t,a);if(!l)return;let r=state.c4_qty||{},s="number"==typeof r[a]?r[a]:1,i=l.spaceRequired||1;e+=s*i})}return e}function getRemainingPorts(){return getTotalPorts()-calculateUsedPortsForC4Model()}function computeBlanksForRemaining(e){return e<=0?{triple:0,single:0,remaining:0}:{triple:Math.floor(e/3),single:e%3,remaining:e}}function removeManualBlanksFromAccessories(){let e=["PB/TB","PB/SB"];Array.isArray(state.c5)&&(state.c5=state.c5.filter(t=>!e.includes(t))),state.c5_qty&&e.forEach(e=>{state.c5_qty[e]=void 0});let t=pickersRoot.querySelector('section[data-spec="c5"]');t&&t.querySelectorAll(".swatch").forEach(e=>{let t=e.querySelector("input");if(t&&("PB/TB"===t.value||"PB/SB"===t.value)){t.checked=!1,e.dataset.checked="false";let a=e.querySelector(".qty-wrap");a&&(a.style.visibility="hidden")}})}function updateBlanksDisplay(){let e=document.querySelector(".product");if(!e||(e.querySelectorAll('p[data-part-id="PB/TB-auto"], p[data-part-id="PB/SB-auto"]').forEach(e=>e.remove()),!state.c2[0]))return;removeManualBlanksFromAccessories();let t=getRemainingPorts(),a=computeBlanksForRemaining(Math.max(0,t));if(a.triple>0){let l=document.createElement("p");l.dataset.partId="PB/TB-auto",l.dataset.spec="blanks",l.textContent=`TRIPLE POLE BLANK \xd7 ${a.triple}`,e.appendChild(l)}if(a.single>0){let r=document.createElement("p");r.dataset.partId="PB/SB-auto",r.dataset.spec="blanks",r.textContent=`SINGLE POLE BLANK \xd7 ${a.single}`,e.appendChild(r)}let s=pickersRoot.querySelector('section[data-spec="c5"]');if(s){let i=s.querySelector(".auto-blanks-note");i&&i.remove();let o=document.createElement("div");o.className="auto-blanks-note",o.style.marginTop="8px",o.style.fontSize="13px",o.style.color="#333",o.textContent=`Required blanks: ${a.triple} triple pole(s), ${a.single} single pole(s)`,s.appendChild(o)}}const C3_UNIT_CAP=2;function getC3CurrentUnits(){let e=0;if(!Array.isArray(state.c3))return 0;let t=state.c3_qty||{};return state.c3.forEach(a=>{e+="number"==typeof t[a]?t[a]:1}),e}function freeUpC3Units(e){for(;getC3CurrentUnits()>e&&state.c3.length>0;){let t=state.c3.shift();state.c3_qty&&(state.c3_qty[t]=void 0);let a=document.querySelector(`.product p[data-part-id="${t}"]`);a&&a.remove();let l=pickersRoot.querySelector('section[data-spec="c3"]');l&&l.querySelectorAll(".swatch").forEach(e=>{let a=e.querySelector("input");if(a&&a.value===t){a.checked=!1,e.dataset.checked="false";let l=e.querySelector(".qty-wrap");l&&(l.style.visibility="hidden")}})}}function enforceMaxForSpecByPorts(e){if(!Array.isArray(state[e.id])||"c4"!==e.id)return;let t=pickersRoot.querySelector(`section[data-spec="${e.id}"]`),a=getTotalPorts(),l=calculateUsedPortsForC4Model();for(;l>a&&state[e.id].length>0;){let r=state[e.id].shift();t&&t.querySelectorAll(".swatch").forEach(e=>{let t=e.querySelector("input");if(t&&t.value===r){e.dataset.checked="false",t.checked=!1;let a=e.querySelector(".qty-wrap");a&&(a.style.visibility="hidden")}});let s=document.querySelector(`.product p[data-part-id="${r}"]`);s&&s.remove(),e.allowQuantity&&(state[`${e.id}_qty`][r]=void 0),l=calculateUsedPortsForC4Model()}updateCounters(),updateTotalCost(),updateDownloadButtonState()}function createOrUpdateSpaceBarInC4(){let e=pickersRoot.querySelector('section[data-spec="c4"]');if(e&&!e.querySelector(".space-bar")){let t=document.createElement("div");t.className="space-bar",t.style.position="relative",t.style.height="18px",t.style.background="#e9e9e9",t.style.borderRadius="9px",t.style.overflow="hidden",t.style.marginBottom="8px";let a=document.createElement("div");a.className="space-bar-fill",a.style.height="100%",a.style.width="0%",a.style.transition="width 240ms ease";let l=document.createElement("div");l.className="space-bar-text",l.style.position="absolute",l.style.left="50%",l.style.top="50%",l.style.transform="translate(-50%, -50%)",l.style.fontSize="12px",l.style.color="#222",t.appendChild(a),t.appendChild(l);let r=e.querySelector(".swatch-grid");r?e.insertBefore(t,r):e.appendChild(t)}}function updateSpaceBar(){let e=pickersRoot.querySelector('section[data-spec="c4"]');if(!e)return;createOrUpdateSpaceBarInC4();let t=getTotalPorts(),a=calculateUsedPortsForC4Model(),l=e.querySelector(".space-bar-fill"),r=e.querySelector(".space-bar-text");l&&(l.style.width=Math.min(100,Math.round(a/(t||1)*100))+"%",a>=t?l.style.background="#e74c3c":l.style.background="#27ae60"),r&&(r.textContent=`${a}/${t} ways used`);let s=document.getElementById("count-c4");if(s){s.textContent=String(a);let i=pickersRoot.querySelector('section[data-spec="c4"]');if(i){let o=i.querySelector(".field-note span");o&&(o.innerHTML=`Used: <strong id="count-c4">${a}</strong> / ${t} ports`);let n=i.querySelector(".max-label");n&&(n.textContent=`Max selectable: ${t} ports`)}}updateBlanksDisplay(),updateDownloadButtonState()}function createSwatch(e,t,a,l,r={}){`${a}-${t}`.toLowerCase().replace(/\s+/g,"-");let s=document.createElement("label");s.className="swatch",s.dataset.checked="false",s.dataset.partId=e,s.title=`${t} (${e})`;let i=document.createElement("input");i.type="checkbox",i.name=a,i.value=e,i.className="swatch-input";let o=document.createElement("span");o.className="tick",o.textContent="✓";let n=document.createElement("span");if(n.className="swatch-label",n.textContent=t,s.appendChild(i),s.appendChild(o),s.appendChild(n),r.allowQuantity){let c=document.createElement("div");c.className="qty-wrap",c.style.visibility="hidden",c.style.display="inline-flex",c.style.alignItems="center",c.style.marginLeft="8px";let d=document.createElement("button");d.type="button",d.className="qty-minus",d.textContent="−",d.style.width="26px",d.style.height="26px";let p=document.createElement("span");p.className="qty",p.textContent="1",p.dataset.value="1",p.style.minWidth="20px",p.style.textAlign="center",p.style.display="inline-block";let u=document.createElement("button");u.type="button",u.className="qty-plus",u.textContent="+",u.style.width="26px",u.style.height="26px",c.appendChild(d),c.appendChild(p),c.appendChild(u),s.appendChild(c)}return s}function renderPickers(){pickersRoot.innerHTML="",PICKERS.forEach(e=>{let t=document.createElement("hr");t.style.border="none",t.style.borderTop="1px solid var(--border)",t.style.margin="16px 0",pickersRoot.appendChild(t);let a=document.createElement("section");a.className="section",a.dataset.spec=e.id;let l=document.createElement("div");l.className="picker-heading";let r=document.createElement("span");r.className="picker-title",r.textContent=e.title;let s=document.createElement("img");if(s.className="picker-icon",s.src=`productImages/${e.title}.jpg`,s.alt=`${a} icon`,l.appendChild(r),l.appendChild(s),a.appendChild(l),"c4"===e.id){let i=document.createElement("div");i.className="space-bar-placeholder",a.appendChild(i)}let o=document.createElement("div");o.className="swatch-grid";let n=e.palette||[];n.forEach(t=>{let a=createSwatch(t.partID,t.name,e.id,"multi"===e.type,{allowQuantity:!!e.allowQuantity}),l=a.querySelector("input"),r=a.querySelector(".qty-wrap"),s=a.querySelector(".qty"),i=a.querySelector(".qty-plus"),n=a.querySelector(".qty-minus"),c=state[e.id].includes(t.partID);if(a.dataset.checked=c?"true":"false",l.checked=c,r&&(r.style.visibility=c?"visible":"hidden"),s&&state[`${e.id}_qty`]&&"number"==typeof state[`${e.id}_qty`][t.partID]){let d=state[`${e.id}_qty`][t.partID];s.dataset.value=String(d),s.textContent=String(d)}else s&&(s.dataset.value="1",s.textContent="1");i&&n&&s&&(i.addEventListener("click",a=>{if(a.preventDefault(),!state[e.id].includes(t.partID)){l.checked=!0,l.dispatchEvent(new Event("change",{bubbles:!0}));return}let r=Number(s.dataset.value||"1"),i=findPaletteEntryByPartID(e.palette,t.partID)||findPaletteEntryByPartID(OUTGOER_LESSTHAN_125A_TYPES,t.partID)||findPaletteEntryByPartID(OUTGOER_125A_OR_MORE_TYPES,t.partID),o=i&&i.spaceRequired||1;if("c4"===e.id){let n=getTotalPorts(),c=calculateUsedPortsForC4Model();if(c+o>n)return}else if("c3"===e.id){let d=getC3CurrentUnits();if(d+1>2)return}let p=r+1;s.dataset.value=String(p),s.textContent=String(p),state[`${e.id}_qty`][t.partID]=p;let u=document.querySelector(`.product p[data-part-id="${t.partID}"]`);u&&(u.textContent=`${t.name} \xd7 ${p}`),updateSpaceBar(),updateTotalCost(),updateCounters()}),n.addEventListener("click",a=>{a.preventDefault();let r=Number(s.dataset.value||"1");if(r<=1){l.checked=!1,l.dispatchEvent(new Event("change",{bubbles:!0}));return}let i=r-1;s.dataset.value=String(i),s.textContent=String(i),state[`${e.id}_qty`][t.partID]=i;let o=document.querySelector(`.product p[data-part-id="${t.partID}"]`);o&&(o.textContent=`${t.name} \xd7 ${i}`),updateSpaceBar(),updateTotalCost(),updateCounters()})),l.addEventListener("change",()=>{let r=document.querySelector(".product"),s=t.partID;if("single"===e.type){if(l.checked){state[e.id]=[s],o.querySelectorAll(".swatch").forEach(t=>{let a=t.querySelector("input").value;if(a===s)t.dataset.checked="true",t.querySelector("input").checked=!0;else{t.dataset.checked="false",t.querySelector("input").checked=!1,r.querySelectorAll(`p[data-part-id="${a}"]`).forEach(e=>e.remove());let l=t.querySelector(".qty-wrap");l&&(l.style.visibility="hidden"),e.allowQuantity&&(state[`${e.id}_qty`][a]=void 0);let i=t.querySelector(".qty");i&&(i.dataset.value="1",i.textContent="1")}}),r.querySelectorAll(`p[data-spec="${e.id}"]`).forEach(e=>e.remove());let i=document.createElement("p"),n=e.allowQuantity&&state[`${e.id}_qty`][s]||1;i.textContent=e.allowQuantity?`${t.name} \xd7 ${n}`:t.name,i.dataset.partId=s,i.dataset.spec=e.id,r.appendChild(i);let c=a.querySelector(".qty-wrap");c&&(c.style.visibility="visible"),e.allowQuantity&&(state[`${e.id}_qty`][s]=state[`${e.id}_qty`][s]||1);let d=a.querySelector(".qty");if(d){let p=state[`${e.id}_qty`][s]||1;d.dataset.value=String(p),d.textContent=String(p)}}else{state[e.id]=[],r.querySelectorAll(`p[data-part-id="${s}"]`).forEach(e=>e.remove()),a.dataset.checked="false";let u=a.querySelector(".qty-wrap");u&&(u.style.visibility="hidden");let y=a.querySelector(".qty");y&&(y.dataset.value="1",y.textContent="1")}}else{let C=new Set(state[e.id]);if(l.checked){if("c4"===e.id){let $=findPaletteEntryByPartID(e.palette,s),m=$&&$.spaceRequired||1,P=getTotalPorts(),S=calculateUsedPortsForC4Model();if(S+m>P)return}else if("c3"===e.id){let E=getC3CurrentUnits();E+1>2&&freeUpC3Units(1)}if("c3"===e.id)C.has(s)||C.add(s);else{if("c4"!==e.id&&C.size>=(e.max||2)){let f=state[e.id][0];C.delete(f),o.querySelectorAll(".swatch").forEach(t=>{let a=t.querySelector("input").value;if(a===f){t.dataset.checked="false",t.querySelector("input").checked=!1;let l=document.querySelector(`.product p[data-part-id="${f}"]`);l&&l.remove();let r=t.querySelector(".qty-wrap");r&&(r.style.visibility="hidden"),e.allowQuantity&&(state[`${e.id}_qty`][f]=void 0);let s=t.querySelector(".qty");s&&(s.dataset.value="1",s.textContent="1")}})}C.add(s)}a.dataset.checked="true";let q=document.querySelector(`.product p[data-part-id="${s}"]`);if(!q){let h=document.createElement("p"),_=e.allowQuantity&&state[`${e.id}_qty`][s]||1;h.textContent=e.allowQuantity?`${t.name} \xd7 ${_}`:t.name,h.dataset.partId=s,h.dataset.spec=e.id,document.querySelector(".product").appendChild(h)}let B=a.querySelector(".qty-wrap");B&&(B.style.visibility="visible"),e.allowQuantity&&(state[`${e.id}_qty`][s]=state[`${e.id}_qty`][s]||1);let A=a.querySelector(".qty");if(A){let I=state[`${e.id}_qty`][s]||1;A.dataset.value=String(I),A.textContent=String(I)}}else{C.delete(s),a.dataset.checked="false";let g=r.querySelector(`p[data-part-id="${s}"]`);g&&g.remove();let D=a.querySelector(".qty-wrap");D&&(D.style.visibility="hidden"),e.allowQuantity&&(state[`${e.id}_qty`][s]=void 0);let v=a.querySelector(".qty");v&&(v.dataset.value="1",v.textContent="1")}state[e.id]=Array.from(C)}if("c4"===e.id)enforceMaxForSpecByPorts(e);else if("c3"===e.id){let R=getC3CurrentUnits();R>2&&freeUpC3Units(2)}if(updateCounters(),updateTotalCost(),"c2"===e.id){updateOutgoerAvailability();let x=PICKERS.find(e=>"c4"===e.id);x&&enforceMaxForSpecByPorts(x)}"c4"===e.id&&updateSpaceBar(),"c3"===e.id&&(updateCounters(),updateTotalCost())}),o.appendChild(a)}),a.appendChild(o);let c=document.createElement("div");c.className="field-note";let d=document.createElement("span");if("c4"===e.id){let p=calculateUsedPortsForC4Model(),u=getTotalPorts();d.innerHTML=`Used: <strong id="count-${e.id}">${p}</strong> / ${u} ports`}else if("c3"===e.id){let y=getC3CurrentUnits();d.innerHTML=`Selected units: <strong id="count-${e.id}">${y}</strong> / 2`}else d.innerHTML=`Selected: <strong id="count-${e.id}">${state[e.id].length}</strong> / ${e.max||("multi"===e.type?2:1)}`;if(c.appendChild(d),"multi"===e.type){let C=document.createElement("div");C.className="max-label",C.style.color="var(--muted)",C.style.fontSize="12px","c4"===e.id?C.textContent=`Max selectable: ${getTotalPorts()} ports`:"c3"===e.id?C.textContent="Max units: 2":C.textContent=`Max selectable: ${e.max||2}`,c.appendChild(C)}pickersRoot.appendChild(a)}),updateSpaceBar(),updateBlanksDisplay(),updateCounters(),updateDownloadButtonState()}function updateCounters(){PICKERS.forEach(e=>{let t=document.getElementById(`count-${e.id}`);t&&("c4"===e.id?t.textContent=String(calculateUsedPortsForC4Model()):"c3"===e.id?t.textContent=String(getC3CurrentUnits()):t.textContent=String(state[e.id].length))}),updateTotalCost()}function updateTotalCost(){let e=0;PICKERS.forEach(t=>{let a=t.palette||[];state[t.id].forEach(l=>{let r=findPaletteEntryByPartID(a,l);if(!r)return;let s=1;t.allowQuantity&&state[`${t.id}_qty`]&&(s=state[`${t.id}_qty`][l]||1),e+=(r.cost||0)*s})});let t=document.getElementById("total-cost");t&&(t.textContent=`Total Cost: \xa3${e}`),updateDownloadButtonState()}function updateOutgoerAvailability(){let e=PICKERS.find(e=>"c3"===e.id),t=PICKERS.find(e=>"c4"===e.id);if(!e||!t)return;let a=pickersRoot.querySelector('section[data-spec="c3"]');if(!a)return;let l=a.querySelector(".swatch-grid"),r=state.c2[0],s=!1,i=6;if(r){let o=findPaletteEntryByPartID(SPINE_TYPES,r);o&&(i=o.max||6,o.supportsLargeOutgoer&&(s=!0))}l&&l.querySelectorAll(".swatch").forEach(e=>{if(s)setSwatchDisabled(e,!1);else{if("true"===e.dataset.checked){let t=e.querySelector("input");if(t){let a=t.value;t.checked=!1,e.dataset.checked="false";let l=document.querySelector(`.product p[data-part-id="${a}"]`);l&&l.remove()}}setSwatchDisabled(e,!0)}}),s||(Array.isArray(state.c3)&&state.c3.forEach(t=>{e.allowQuantity&&(state[`${e.id}_qty`][t]=void 0)}),state.c3=[]),updateSpaceBar(),updateBlanksDisplay(),updateCounters(),updateDownloadButtonState()}function reset(){state.c1=[],state.c2=[],state.c3=[],state.c4=[],state.c5=[],PICKERS.forEach(e=>{e.allowQuantity&&(state[`${e.id}_qty`]={})}),renderPickers();let e=document.querySelector(".product");if(e)for(;e.firstChild;)e.removeChild(e.firstChild);updateOutgoerAvailability(),updateTotalCost(),updateDownloadButtonState()}function downloadCSV(){let e=document.querySelector(".product");if(!e||calculateUsedPortsForC4Model()>getTotalPorts())return;let t=Array.from(e.querySelectorAll("p")).map(e=>{let t=e.textContent.replace(/\u00d7/g,"x");return`"${t}"`}),a=t.join("\n"),l=new Blob([a],{type:"text/csv"}),r=URL.createObjectURL(l),s=document.createElement("a");s.href=r,s.download="products.csv",document.body.appendChild(s),s.click(),s.remove(),URL.revokeObjectURL(r)}function updateDownloadButtonState(){let e=document.getElementById("download");if(!e)return;let t=calculateUsedPortsForC4Model(),a=getTotalPorts(),l=document.querySelector(".product"),r=l&&l.querySelectorAll("p").length>0,s=t>a||!r;e.disabled=s,s?(e.style.opacity="0.45",e.style.pointerEvents="none"):(e.style.opacity="",e.style.pointerEvents="")}document.getElementById("reset")?.addEventListener("click",reset),document.getElementById("download")?.addEventListener("click",downloadCSV),renderPickers(),updateOutgoerAvailability(),updateSpaceBar(),updateBlanksDisplay(),updateDownloadButtonState();
