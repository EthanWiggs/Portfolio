function createSwatchNode(e,t,a,n){const s=el("label",{class:"swatch",dataset:{partId:e}}),i=el("input");i.type="checkbox",i.name=a,i.value=e,i.className="swatch-input";const l=el("span",{class:"tick",text:"✓"}),d=el("span",{class:"swatch-label",text:t});if(s.appendChild(i),s.appendChild(l),s.appendChild(d),n){const t=el("div",{class:"qty-wrap"}),n=el("button");n.type="button",n.className="qty-minus",n.textContent="−";const i=el("span",{class:"qty"});i.textContent="1",i.dataset.value="1";const l=el("button");l.type="button",l.className="qty-plus",l.textContent="+";const d=e=>{e.preventDefault(),e.stopPropagation()};n.addEventListener("click",(t=>{d(t),handleQtyClick(a,e,-1)})),l.addEventListener("click",(t=>{d(t),handleQtyClick(a,e,1)})),t.appendChild(n),t.appendChild(i),t.appendChild(l),s.appendChild(t)}return s}function renderPickers(){if(!pickersRoot)return;pickersRoot.innerHTML="",PICKERS.forEach((e=>{const t=(e.title||"").split(":"),a=(t[0]||"").trim(),n=(t.slice(1).join(":")||e.title).trim(),s=el("div",{class:"step-row"}),i=el("div",{class:"step-label",text:a}),l=el("div",{class:"step-divider"});s.appendChild(i),s.appendChild(l),pickersRoot.appendChild(s);const d=el("section");d.className="section",d.dataset.spec=e.id;const c=el("div",{class:"picker-heading"}),p=el("span",{class:"picker-title",text:n}),o=n.replace(/^Step\s+[^:]+:\s*/i,"").trim(),r=el("img",{class:"picker-icon",src:`productImages/${o}.jpg`,alt:`${e.title} icon`});r.addEventListener("click",(t=>{t.stopPropagation(),showImageModal&&showImageModal(r.src,e.title)})),c.appendChild(p),c.appendChild(r),d.appendChild(c),"c4"===e.id&&d.appendChild(el("div",{class:"space-bar-placeholder"}));const h=el("div",{class:"swatch-grid"});(e.palette||[]).forEach((t=>{const a=createSwatchNode(t.partID,t.name,e.id,!!e.allowQuantity),n=state[e.id].includes(t.partID);a.dataset.checked=n?"true":"false";const s=a.querySelector("input");s.checked=n,n&&a.classList.add("show-qty");const i=a.querySelector(".qty");if(i){const a=state[e.id+"_qty"]&&"number"==typeof state[e.id+"_qty"][t.partID]?state[e.id+"_qty"][t.partID]:1;i.dataset.value=String(a),i.textContent=String(a)}s.addEventListener("change",(()=>handleCheckboxChange(e,t,s,a,h))),h.appendChild(a)})),d.appendChild(h);const C=el("div",{class:"field-note"}),u=el("span",{class:"count-wrapper"});u.id=`count-${e.id}-wrapper`;const x=el("strong");if(x.id=`count-${e.id}`,"c4"===e.id){x.textContent=String(calculateUsedPortsForC4Model()),u.innerHTML="Used: ",u.appendChild(x);const e=el("span");e.id="count-c4-total",e.textContent=` / ${getTotalPorts()} ways`,u.appendChild(e)}else if("c3"===e.id)x.textContent=String(getC3CurrentUnits()),u.innerHTML="Selected units: ",u.appendChild(x),u.insertAdjacentText("beforeend",` / ${C3_UNIT_CAP}`);else{x.textContent=String(state[e.id].length);const t=e.max||("multi"===e.type?2:1);u.innerHTML="Selected: ",u.appendChild(x),u.insertAdjacentText("beforeend",` / ${t}`)}if(C.appendChild(u),"multi"===e.type){const t=el("div",{class:"max-label"});t.id=`max-${e.id}`,t.style.color="var(--muted)",t.style.fontSize="12px","c4"===e.id?t.textContent=`Max selectable: ${getTotalPorts()} ways`:"c3"===e.id?t.textContent=`Max units: ${C3_UNIT_CAP}`:t.textContent=`Max selectable: ${e.max||2}`,C.appendChild(t)}d.appendChild(C),pickersRoot.appendChild(d)}));const e=el("hr");e.style.border="none",e.style.borderTop="2px solid #641b1F",e.style.margin="16px 0",pickersRoot.appendChild(e);const t=el("section");t.className="section",t.dataset.spec="extra-notes";const a=el("div",{class:"picker-heading"}),n=el("span",{class:"picker-title",text:"Extra Notes"});a.appendChild(n),t.appendChild(a);const s=el("div",{class:"field-note"}),i=el("textarea",{id:"extra-notes-textarea",placeholder:"Any extra notes, comments, or special requirements...",rows:"4"});i.value=state.extraNotes||"",i.addEventListener("input",(()=>{state.extraNotes=sanitizeUserInput(i.value)})),s.appendChild(i),t.appendChild(s),pickersRoot.appendChild(t);const l=el("div",{class:"disclaimer-wrap"}),d=el("input");d.type="checkbox",d.id="disclaimer-checkbox",d.checked=!!state.disclaimerAgreed;const c=el("label");c.setAttribute("for","disclaimer-checkbox"),c.textContent="I agree to be contacted about my enquiry and understand my information will only be used for this purpose.",l.appendChild(d),l.appendChild(c),d.addEventListener("change",(e=>{state.disclaimerAgreed=!!e.target.checked,updateDownloadButtonState()})),pickersRoot.appendChild(l),updateSpaceBar(),updateBlanksDisplay(),updateCounters(),updateDownloadButtonState()}