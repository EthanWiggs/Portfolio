function handleCheckboxChange(e,t,a,r,c){const d=t.partID;if("c5"===e.id&&d===TERMINAL_SHROUD_PID&&(a.checked?state.terminalShroudUserChanged=!1:state.terminalShroudUserChanged=!0),"single"===e.type)if(a.checked){state[e.id]=[d],c.querySelectorAll(".swatch").forEach((t=>{const a=t.querySelector("input").value;if(a===d)t.dataset.checked="true",t.querySelector("input").checked=!0,t.classList.add("show-qty");else{t.dataset.checked="false",t.querySelector("input").checked=!1,t.classList.remove("show-qty"),document.querySelectorAll(`.product p[data-part-id="${a}"]`).forEach((e=>e.remove())),e.allowQuantity&&(state[e.id+"_qty"][a]=void 0);const r=t.querySelector(".qty");r&&(r.dataset.value="1",r.textContent="1")}})),document.querySelectorAll(`.product p[data-spec="${e.id}"]`).forEach((e=>e.remove()));const t=e.allowQuantity&&state[e.id+"_qty"][d]||1;renderProductParagraph(d,e.id,t),e.allowQuantity&&(state[e.id+"_qty"][d]=state[e.id+"_qty"][d]||1)}else state[e.id]=[],productDiv?.querySelectorAll(`p[data-spec="${e.id}"]`).forEach((e=>e.remove())),r.dataset.checked="false",r.classList.remove("show-qty"),e.allowQuantity&&(state[e.id+"_qty"]={});else{const t=new Set(state[e.id]);if(a.checked){if("c4"===e.id){const t=findPaletteEntryByPartID(e.palette,d),r=t&&t.spaceRequired||1,c=getTotalPorts();if(calculateUsedPortsForC4Model()+r>c)return void(a.checked=!1)}else if("c3"===e.id){if(getC3CurrentUnits()+1>C3_UNIT_CAP)return void(a.checked=!1)}else if(t.size>=(e.max||2)){const a=state[e.id][0];t.delete(a);const r=c.querySelector(`.swatch[data-part-id="${a}"]`);if(r){r.dataset.checked="false",r.querySelector("input").checked=!1,r.classList.remove("show-qty");const t=document.querySelector(`.product p[data-part-id="${a}"]`);t&&t.remove(),e.allowQuantity&&(state[e.id+"_qty"][a]=void 0);const c=r.querySelector(".qty");c&&(c.dataset.value="1",c.textContent="1")}}if(t.add(d),r.dataset.checked="true",r.classList.add("show-qty"),e.allowQuantity&&(state[e.id+"_qty"][d]=state[e.id+"_qty"][d]||1),d!==TERMINAL_SHROUD_PID){const t=e.allowQuantity&&state[e.id+"_qty"][d]||1;renderProductParagraph(d,e.id,t)}}else{t.delete(d),r.dataset.checked="false",r.classList.remove("show-qty");const a=productDiv?.querySelector(`p[data-part-id="${d}"]`);a&&a.remove(),e.allowQuantity&&(state[e.id+"_qty"][d]=void 0);const c=r.querySelector(".qty");c&&(c.dataset.value="1",c.textContent="1")}state[e.id]=Array.from(t)}if("c4"===e.id&&enforcePortsForC4(),"c3"===e.id&&getC3CurrentUnits()>C3_UNIT_CAP&&freeUpC3Units(C3_UNIT_CAP),updateCounters(),updateTotalCost(),"c2"===e.id){updateOutgoerAvailability(),enforcePortsForC4();calculateUsedPortsForC4Model()>getTotalPorts()&&resetC4Selections()}"c3"!==e.id&&"c2"!==e.id||updateBlanksDisplay(),updateTerminalShrouds(),"c4"===e.id&&updateSpaceBar()}function handleQtyClick(e,t,a){const r=PICKERS.find((t=>t.id===e));if(!r||!r.allowQuantity)return;const c=pickersRoot?.querySelector(`section[data-spec="${e}"] .swatch[data-part-id="${t}"]`);if(!c)return;const d=c.querySelector("input");if(!d.checked&&a>0)return d.checked=!0,void d.dispatchEvent(new Event("change",{bubbles:!0}));const s=state[e+"_qty"]||{},o="number"==typeof s[t]?s[t]:1,i=o+a;if(i<=0)return"c5"===e&&t===TERMINAL_SHROUD_PID&&(state.terminalShroudUserChanged=!0),d.checked=!1,void d.dispatchEvent(new Event("change",{bubbles:!0}));if("c4"===e){const e=findPaletteEntryByPartID(OUTGOER_LESSTHAN_125A_TYPES,t),a=e&&e.spaceRequired||1;if(calculateUsedPortsForC4Model()+(i-o)*a>getTotalPorts())return}else if("c3"===e){if(getC3CurrentUnits()+(i-o)>C3_UNIT_CAP)return}else if("c5"===e&&t===TERMINAL_SHROUD_PID){const e=getTotalOutgoerCount();if(i>e)return;i!==e&&(state.terminalShroudUserChanged=!0)}state[e+"_qty"][t]=i;const n=c.querySelector(".qty");n&&(n.dataset.value=String(i),n.textContent=String(i)),renderProductParagraph(t,e,i),updateSpaceBar(),updateTotalCost(),updateCounters(),"c3"===e&&updateBlanksDisplay(),("c3"===e||"c4"===e||"c5"===e&&t===TERMINAL_SHROUD_PID)&&updateTerminalShrouds()}