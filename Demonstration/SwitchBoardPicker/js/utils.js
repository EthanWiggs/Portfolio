const $=(t,e=document)=>e.querySelector(t),$$=(t,e=document)=>Array.from(e.querySelectorAll(t));function sanitizeCSVValue(t){if(null==t)return"";const e=String(t).trim();return/^[=+@-]/.test(e)?"'"+e:e}function escapeCRLF(t){return t&&"string"==typeof t?t.replace(/[\r\n]/g," ").replace(/%0[Ad]/gi,""):""}function sanitizeUserInput(t){return t&&"string"==typeof t?t.replace(/[\x00\x01-\x08\x0b\x0c\x0e-\x1f\x7f]/g,""):""}function checkRateLimit(t){const e=Date.now(),n=state["last"+t+"Time"]||0,r=RATE_LIMITS[t.toLowerCase()]||3e3,a=e-n;if(a<r){const e=Math.ceil((r-a)/1e3);return console.warn(`Rate limited: ${t}. Try again in ${e}s.`),!1}return state["last"+t+"Time"]=e,!0}function el(t,e={}){const n=document.createElement(t);return Object.entries(e).forEach((([t,e])=>{"class"===t?n.className=e:"dataset"===t?Object.assign(n.dataset,e):"text"===t?n.textContent=e:n.setAttribute(t,e)})),n}function normalizePID(t){return null==t?"":String(t).trim().toUpperCase()}const ALL_PALETTES_ARRAY=[].concat(PANEL_BOARD_BASE_SECTION,INCOMER_TYPES,SPINE_TYPES,OUTGOER_LESSTHAN_125A_TYPES,OUTGOER_125A_OR_MORE_TYPES,ACCESSORIES),PALETTE_MAP=new Map;function findPaletteEntryByPartID(t,e){if(Array.isArray(t)&&void 0!==e){const n=normalizePID(e);return t.find((t=>normalizePID(t.partID)===n||normalizePID(t.partId)===n||normalizePID(t.id)===n))||null}const n=normalizePID(t);return n&&PALETTE_MAP.get(n)||null}ALL_PALETTES_ARRAY.forEach((t=>{t&&t.partID&&PALETTE_MAP.set(normalizePID(t.partID),t)}));