function updateBlanksDisplay(){if(!productDiv)return;if(productDiv.querySelectorAll('p[data-part-id="PB/TB"], p[data-part-id="PB/SB"], p[data-part-id="PB/TB2"]').forEach((e=>e.remove())),!state.c2[0]){Array.from(productDiv.querySelectorAll(".product-section")).forEach((e=>{const t=e.querySelector(".product-section-list");t&&0!==t.children.length||e.remove()}));const e=pickersRoot?.querySelector('section[data-spec="c5"]');if(e){const t=e.querySelector(".auto-blanks-note");t&&t.remove()}return}const e=getTotalPorts(),t=calculateUsedPortsForC4Model(),r=Math.max(0,e-t),o=computeBlanksForRemaining(r);o.triple>0&&renderProductParagraph("PB/TB","blanks",o.triple),o.single>0&&renderProductParagraph("PB/SB","blanks",o.single);const a=findPaletteEntryByPartID(SPINE_TYPES,state.c2[0]);if(a&&a.supportsLargeOutgoer){const e=getC3CurrentUnits(),t=Math.max(0,2-e);t>0&&renderProductParagraph("PB/TB2","blanks",t)}Array.from(productDiv.querySelectorAll(".product-section")).forEach((e=>{const t=e.querySelector(".product-section-list");t&&0!==t.children.length||e.remove()}));const c=pickersRoot?.querySelector('section[data-spec="c5"]');if(c){const e=c.querySelector(".auto-blanks-note");e&&e.remove();const t=el("div",{class:"auto-blanks-note"});t.textContent=`Required blanks: ${o.triple} triple pole(s), ${o.single} single pole(s)`,c.appendChild(t)}updateCounters(),updateDownloadButtonState()}function ensureSpaceBar(){const e=pickersRoot?.querySelector('section[data-spec="c4"]');if(!e)return;if(e.querySelector(".space-bar"))return;const t=el("div",{class:"space-bar"});t.appendChild(el("div",{class:"space-bar-fill"})),t.appendChild(el("div",{class:"space-bar-text"}));const r=e.querySelector(".swatch-grid");r?e.insertBefore(t,r):e.appendChild(t)}function updateSpaceBar(){const e=pickersRoot?.querySelector('section[data-spec="c4"]');if(!e)return;ensureSpaceBar();const t=getTotalPorts(),r=calculateUsedPortsForC4Model(),o=Math.min(100,Math.round(r/(t||1)*100)),a=e.querySelector(".space-bar-fill"),c=e.querySelector(".space-bar-text");a&&(a.style.width=o+"%"),c&&(c.textContent=`${r}/${t} ways used`);const n=document.getElementById("count-c4");n&&(n.textContent=String(r));const s=document.getElementById("max-c4");s&&(s.textContent=`Max selectable: ${t} ways`);const l=document.getElementById("count-c4-total");l&&(l.textContent=` / ${t} ways`),updateBlanksDisplay(),updateDownloadButtonState()}